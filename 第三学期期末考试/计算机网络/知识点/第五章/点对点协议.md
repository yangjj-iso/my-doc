# 第五章补充报告：高级链路层协议与链路虚拟化深度剖析

## 摘要

本报告旨在为《计算机网络》第五章链路层内容提供详尽的补充研究，重点聚焦于点对点协议（Point-to-Point Protocol, PPP）的深层架构机制以及以异步传输模式（Asynchronous Transfer Mode, ATM）和多协议标签交换（Multiprotocol Label Switching, MPLS）为代表的链路虚拟化技术。不同于以太网的广播共享介质模型，这些协议主要解决广域网（WAN）环境下的点对点连接、用户身份认证、多协议封装以及流量工程问题。本报告将以专家级视角，深入剖析PPP的帧格式、字节填充算法、LCP状态机转换逻辑及认证交互细节；详述PPPoE如何将PPP适配于以太网环境及其发现阶段的报文交互；解构ATM的信元交换原理、AAL5适配层机制及IP over ATM的逻辑子网模型；最后对比分析MPLS如何融合ATM与IP路由的优势，实现高效的标签交换。报告内容基于RFC标准文档及行业技术白皮书，力求在理论深度与工程实践之间建立严密的逻辑联系。

---

## 1. 点对点协议（PPP）架构深度解析

在数据链路层的演进历史中，点对点协议（PPP）占据着承上启下的核心地位。它不仅取代了早期的SLIP（Serial Line Internet Protocol）协议，更定义了一套完整的链路建立、维护与拆除的标准流程，成为现代广域网连接的基石。PPP的设计哲学在于“多协议支持”与“链路控制的可协商性”，这使得它能够在一个物理连接上同时承载IPv4、IPv6、IPX等多种网络层协议。

### 1.1 PPP 协议簇的组成架构

PPP并非单一协议，而是一个由三个核心组件构成的协议簇，各组件在链路建立的不同阶段发挥关键作用：

1. **封装方法（Encapsulation）：** 定义了如何在串行链路上封装多协议数据报。PPP帧格式基于HDLC（High-Level Data Link Control）标准，但在字段定义上进行了优化，以支持多协议复用。
    
2. **链路控制协议（Link Control Protocol, LCP）：** 被称为PPP的“心脏”。它负责链路的建立、配置、测试和拆除。LCP具有极高的灵活性，能够协商最大接收单元（MRU）、认证协议类型、魔术字（Magic Number）等关键链路参数 1。
    
3. **网络控制协议（Network Control Protocols, NCPs）：** 一组协议的统称，用于配置和启用特定的网络层协议。每一个上层协议都有对应的NCP，例如用于IPv4的IPCP（Internet Protocol Control Protocol）和用于IPv6的IPv6CP。这种模块化设计使得PPP能够独立于网络层协议运行，实现了链路层与网络层的解耦 1。
    

### 1.2 PPP 帧格式与字节填充机制

PPP帧的设计目标是透明传输。无论上层数据中包含何种二进制模式，链路层都必须能够准确区分数据负载与帧定界符。

#### 1.2.1 帧结构详解

PPP帧主要由以下字段构成（按传输顺序）：

|**字段名称**|**长度 (字节)**|**描述与功能**|**典型值/备注**|
|---|---|---|---|
|**Flag (标志)**|1|帧的起始和结束定界符|`0x7E` (01111110)|
|**Address (地址)**|1|标识接收站地址|标准PPP中固定为 `0xFF` (广播地址)|
|**Control (控制)**|1|标识帧类型|固定为 `0x03` (无编号信息帧)|
|**Protocol (协议)**|2|标识信息字段中封装的载荷类型|如 `0xC021`(LCP), `0x8021`(IPCP)|
|**Information (信息)**|可变|上层协议数据包|长度受协商的MRU限制 (默认1500)|
|**FCS (帧校验序列)**|2 或 4|用于差错检测的循环冗余校验|通常为16位CRC|
|**Flag (标志)**|1|帧结束定界符|`0x7E`|

在实际应用中，为了节省带宽，PPP允许通过LCP协商“地址/控制字段压缩（ACFC）”和“协议字段压缩（PFC）”。若协商成功，`0xFF 0x03` 这两个字节可以被省略，协议字段也可由2字节压缩为1字节（如果协议ID小于256）4。

#### 1.2.2 协议字段编码规则

协议字段（Protocol Field）的编码具有严格的数学特征，以区分其与数据载荷或填充字节：

- **最低有效位（LSB）必须为1**：这确保了协议字段总是奇数，从而区别于可能出现的偶数填充字节。
    
- **最高有效位（MSB）通常为0**：但在某些压缩模式下可能为1。
    

常见的协议代码分配如下 4：

- `0xC021`: 链路控制协议 (LCP)
    
- `0xC023`: 口令认证协议 (PAP)
    
- `0xC223`: 挑战握手认证协议 (CHAP)
    
- `0x0021`: IPv4 数据报
    
- `0x8021`: IPCP (IPv4 控制协议)
    
- `0x8057`: IPv6CP (IPv6 控制协议)
    

#### 1.2.3 透明传输：字节填充算法

在异步链路上，PPP使用字节填充（Byte Stuffing）来确保数据透明性。标志字段 `0x7E` 用于定界，如果数据负载中恰好出现了 `0x7E`，接收端会误判为帧结束。为此，PPP引入了转义字符 `0x7D`（Control Escape）。

**填充规则：**

1. **标志字符转义：** 若信息字段中出现 `0x7E`，发送端将其转换为两字节序列 `0x7D 0x5E`。
    
    - 计算逻辑：`0x7E` XOR `0x20` = `0x5E`。
        
2. **转义字符转义：** 若信息字段中出现 `0x7D`，发送端将其转换为 `0x7D 0x5D`。
    
    - 计算逻辑：`0x7D` XOR `0x20` = `0x5D`。
        
3. **控制字符转义：** 默认情况下，小于 `0x20` 的ASCII控制字符也可以被转义。例如，字符 `0x03` 会被转换为 `0x7D 0x23`。
    

接收端逆操作：

当接收端遇到 0x7D 时，它会丢弃该字节，并将紧随其后的字节与 0x20 进行异或（XOR）运算，从而恢复原始数据。这种机制虽然简单，但在最坏情况下（数据全为 0x7E 或 0x7D），会导致有效载荷长度翻倍，从而降低链路效率 1。

### 1.3 LCP 有限状态机（FSM）与链路协商

LCP的运作基于一个复杂的有限状态机（Finite State Machine, FSM），RFC 1661 对其进行了严格定义。理解这个状态机是掌握PPP链路建立过程的关键。

#### 1.3.1 LCP 报文类型

LCP报文封装在PPP帧的信息字段中（协议号 `0xC021`）。主要的LCP报文代码（Code）包括：

- **Configure-Request (Code 1):** 配置请求。链路建立的发起方发送此报文，携带期望协商的选项列表（如MRU=1500, Auth=CHAP）。
    
- **Configure-Ack (Code 2):** 配置确认。接收方完全接受请求中的所有选项及参数。
    
- **Configure-Nak (Code 3):** 配置否认。接收方识别选项但认为参数值不可接受，会在Nak报文中携带可接受的参数值建议发送方重试。
    
- **Configure-Reject (Code 4):** 配置拒绝。接收方根本不支持该选项（如未知的压缩算法），要求发送方在后续请求中删除该选项。
    
- **Terminate-Request (Code 5) / Terminate-Ack (Code 6):** 用于链路拆除。
    
- **Code-Reject (Code 7):** 收到未知的LCP代码时发送。
    
- **Echo-Request (Code 9) / Echo-Reply (Code 10):** 用于链路质量检测和环路检测。
    

#### 1.3.2 链路建立过程与状态迁移

PPP链路的生命周期包含五个阶段：**Dead (链路不可用)** -> **Establish (建立)** -> **Authenticate (认证)** -> **Network (网络层协议)** -> **Terminate (终止)**。

1. **Dead 阶段：** 物理层连接未建立。当载波检测信号有效时，进入 Establish 阶段。
    
2. **Establish 阶段：** LCP开始协商。
    
    - 双方互相发送 `Configure-Request`。
        
    - 状态机从 `Request-Sent` 迁移。若收到 `Configure-Ack`，状态变为 `Ack-Received`。
        
    - 只有当双方都发送了请求并收到了对方的 `Configure-Ack` 后，LCP状态才变为 `Opened`。此时链路建立完成。
        
3. **Authenticate 阶段（可选）：** 如果在LCP中协商了认证协议（如CHAP），则进入此阶段。只有认证成功，才会进入 Network 阶段；否则链路直接拆除（进入 Terminate 阶段）。
    
4. **Network 阶段：** NCP（如IPCP）开始工作，协商IP地址等参数。当NCP状态为 `Opened` 时，数据报文开始传输。
    
5. **Terminate 阶段：** 任意一方发送 `Terminate-Request`，收到 `Terminate-Ack` 后回到 Dead 状态 2。
    

#### 1.3.3 环路检测与魔术字（Magic Number）

在LCP协商中，**魔术字**（Magic Number, Option 0x05）是一个至关重要的机制，用于检测链路是否存在环路（Loopback）。

- **原理：** 每个节点随机生成一个32位的数字作为魔术字，并在 `Configure-Request` 中发送给对端。
    
- **检测逻辑：** 如果节点A收到的 `Configure-Request` 中包含的魔术字与自己刚刚发出的魔术字完全相同，它会推断链路可能自环了（即自己发出的报文被环路传回）。
    
- **处理：** 节点A会重新生成一个新的随机魔术字并再次发送 `Configure-Nak` 或新的请求。如果多次冲突，则确认链路存在环路，并采取保护措施 1。
    

### 1.4 PPP 认证协议详解：PAP 与 CHAP

安全性是PPP相对于以太网的一大优势。PPP支持多种认证协议，最常用的是PAP和CHAP。

#### 1.4.1 口令认证协议 (PAP)

PAP (Password Authentication Protocol, RFC 1334) 是一种简单的**两次握手**协议。

- **流程：**
    
    1. 被认证方（Peer）主动发送 `Authenticate-Request`，包中明文包含 `Peer-ID` 和 `Password`。
        
    2. 认证方（Authenticator）查询本地数据库或Radius服务器，若匹配则回送 `Authenticate-Ack`，否则回送 `Authenticate-Nak`。
        
- **安全性缺陷：** 密码以明文（Cleartext）在链路上传输，极易被窃听。此外，PAP缺乏抗重放攻击（Replay Attack）的能力，因为认证请求完全由客户端发起，且内容固定 5。
    

#### 1.4.2 挑战握手认证协议 (CHAP)

CHAP (Challenge Handshake Authentication Protocol, RFC 1994) 采用**三次握手**机制，提供了更高的安全性。

- **流程：**
    
    1. **Challenge（挑战）：** 链路建立后，认证方主动发送一个挑战报文。该报文包含一个随机生成的**Challenge Value**（随机数Nonce）和一个唯一的**Identifier**。
        
    2. Response（响应）： 被认证方收到挑战后，使用共享密钥（Secret，不在链路上传输）与收到的ID、Challenge Value进行拼接，然后计算哈希值（通常是MD5）。
        
        $$Hash = \text{MD5}(\text{Identifier} \parallel \text{Secret} \parallel \text{Challenge Value})$$
        
        计算结果放入 Response 报文中发回。
        
    3. **Verification（验证）：** 认证方使用相同的共享密钥和随机数进行同样的哈希计算。如果计算结果与收到的 `Response` 一致，则发送 `Success`；否则发送 `Failure`。
        
- **安全优势：**
    
    - **密码不传输：** 共享密钥仅存在于通信双方的本地配置中。
        
    - **抗重放：** 每次认证使用不同的随机 Challenge Value，使得截获的响应报文在下一次认证中无效。
        
    - **双向认证：** CHAP可以配置为双向认证，即双方互为认证方和被认证方 7。
        

### 1.5 网络控制协议（NCP）：IPCP

一旦LCP打开且认证通过，PPP进入网络层协议配置阶段。对于IP网络，使用IPCP（RFC 1332）。

IPCP的核心功能包括：

1. **IP地址协商：** 客户端可以发送IP地址为 `0.0.0.0` 的配置请求，服务器在 `Configure-Nak` 中提供一个合法的IP地址，客户端随后的请求中便携带该地址，从而实现动态IP分配。这是拨号上网和宽带接入的基础。
    
2. **TCP/IP头压缩：** 协商使用Van Jacobson (VJ) 压缩算法（RFC 1144），将40字节的TCP/IP头压缩至几字节，极大提高了低速链路的传输效率 1。
    

---

## 2. PPP over Ethernet (PPPoE)：宽带接入的桥梁

随着DSL和光纤接入技术的发展，以太网成为连接用户终端（CPE）的主流技术。然而，ISP（互联网服务提供商）需要一种能够像拨号网络一样进行用户认证、计费和会话管理的机制。PPPoE (RFC 2516) 应运而生，它将PPP帧封装在以太网帧中，结合了以太网的高速特性与PPP的控制能力。

### 2.1 PPPoE 的两阶段交互机制

由于以太网是广播介质，而PPP是点对点协议，PPPoE必须首先解决“寻找对端”的问题。因此，PPPoE协议流程被严格划分为**发现阶段（Discovery Stage）**和**会话阶段（Session Stage）**。

#### 2.1.1 发现阶段 (Discovery Stage)

此阶段的目标是让用户主机（Host）发现接入集中器（Access Concentrator, AC）的MAC地址，并建立一个唯一的会话ID（Session ID）。所有发现阶段的报文使用以太网类型（EtherType） `0x8863` 9。

交互流程包含四个步骤（PADI-PADO-PADR-PADS）：

1. **PADI (PPPoE Active Discovery Initiation):**
    
    - **方向：** 主机 -> 广播。
        
    - **内容：** 主机广播寻找AC，可携带 `Service-Name` 标签（Tag），表明请求的服务类型。
        
    - **目的：** "谁是服务提供商？"
        
2. **PADO (PPPoE Active Discovery Offer):**
    
    - **方向：** AC -> 主机（单播）。
        
    - **内容：** AC收到PADI后，若能提供服务，则回复PADO。包含AC的名称（`AC-Name` Tag）。
        
    - **目的：** "我是服务商，我可以为你服务。"
        
3. **PADR (PPPoE Active Discovery Request):**
    
    - **方向：** 主机 -> 选定的AC（单播）。
        
    - **内容：** 主机可能收到多个AC的PADO，它根据策略选择一个，并发送PADR请求建立会话。
        
    - **目的：** "我选择你，请开启会话。"
        
4. **PADS (PPPoE Active Discovery Session-confirmation):**
    
    - **方向：** AC -> 主机（单播）。
        
    - **内容：** AC生成一个唯一的 **Session ID**，并通过PADS发送给主机。
        
    - **目的：** "会话建立，你的Session ID是X。" 11
        

#### 2.1.2 会话阶段 (Session Stage)

一旦收到PADS，双方进入会话阶段。此时以太网类型变为 `0x8864`。以太网帧的载荷部分就是标准的PPP帧（LCP, CHAP, IPCP, IP Data）。在此阶段，Session ID必须保持不变，用于标识该连接流 10。

当需要断开连接时，任意一方可发送 **PADT (Terminate)** 报文，指定Session ID，通知对端结束会话。

### 2.2 PPPoE 帧格式与开销分析

PPPoE报文头长度为6字节，紧跟在以太网头之后：

|**字段**|**长度 (位)**|**说明**|
|---|---|---|
|**Version**|4|必须为 `0x1`|
|**Type**|4|必须为 `0x1`|
|**Code**|8|标识发现阶段报文类型（如 `0x09` 为 PADI），会话阶段为 `0x00`|
|**Session_ID**|16|发现阶段通常为0（PADS除外），会话阶段为固定分配值|
|**Length**|16|载荷长度（不含PPPoE头）|

MTU 限制与 MSS Clamping 问题：

标准以太网MTU为1500字节。

- PPPoE头部：6字节。
    
- PPP协议ID：2字节。
    
- **PPPoE有效MTU：** $1500 - 6 - 2 = 1492$ 字节。
    

这就导致了一个经典的网络问题：如果用户主机发送1500字节的IP包（DF位=1），路由器无法将其封装入PPPoE帧，只能丢弃并发送ICMP "Fragmentation Needed"。但由于防火墙常拦截ICMP，导致“黑洞”现象（网页打不开，但小包能通）。

解决方案： 路由器通常配置 TCP MSS Clamping（如Cisco的 ip tcp adjust-mss 1452）。在TCP三次握手（SYN包）期间，路由器拦截并修改MSS选项值，将其强制改为1452（1492 - 20字节IP头 - 20字节TCP头），迫使通信双方协商出较小的分段大小，从而避免分片 14。

---

## 3. 链路虚拟化技术：异步传输模式（ATM）

在MPLS普及之前，ATM是实现链路虚拟化和服务质量（QoS）保障的主流技术。ATM的设计初衷是构建一个能够同时承载语音、视频和数据的综合业务数字网（B-ISDN）。

### 3.1 ATM 的核心思想：信元交换

ATM摒弃了变长数据包（Packet）的设计，转而采用固定长度的**53字节信元（Cell）**。

- **结构：** 5字节头部 + 48字节载荷。
    
- **设计妥协：** 48字节载荷是欧洲（主张32字节以降低语音延迟）和美国（主张64字节以提高数据效率）在标准化过程中的政治妥协结果（平均值）15。
    
- **优势：** 固定长度使得硬件交换极其迅速，且传输延迟可预测（Jitter小），非常适合实时业务。
    

### 3.2 虚电路与 VPI/VCI 交换架构

ATM是面向连接的（Connection-Oriented）。通信前必须建立虚电路（Virtual Circuit）。ATM使用两级标识体系：

1. **VPI (Virtual Path Identifier):** 虚路径标识符，用于汇聚一组VC。
    
2. **VCI (Virtual Channel Identifier):** 虚通道标识符，标识具体的逻辑连接。
    

交换原理：

ATM交换机进行的是“标签交换”。每个端口维护一张转发表：

Port_In, VPI_In, VCI_In -> Port_Out, VPI_Out, VCI_Out。

信元到达时，交换机查找表项，替换头部的VPI/VCI值，并将信元转发到出口。这意味着VPI/VCI仅具有本地链路意义，在每一跳都会改变 17。

**头部格式差异：**

- **UNI (用户-网络接口):** 头部包含GFC（通用流量控制）字段，VPI为8位。
    
- **NNI (网络-网络接口):** 去除GFC，VPI扩展为12位，支持更多路径聚合 18。
    

### 3.3 ATM 适配层（AAL）：数据包到信元的桥梁

IP数据包通常远大于48字节，因此需要适配层（AAL）进行**分段与重组（SAR）**。不同的业务类型对应不同的AAL：

- **AAL1:** 恒定比特率（CBR），用于电路仿真（如E1/T1透传）。
    
- **AAL5:** 简单高效适配层（SEAL），是数据通信（IP over ATM）的标准。
    

#### 3.3.1 AAL5 封装机制深度解析

AAL5的设计极度精简，将开销降至最低。其处理IP数据包的过程如下：

1. **封装 (CPCS-PDU):** IP数据包被放入载荷区。
    
2. **填充 (PAD):** 添加0-47字节的填充，确保 `载荷 + PAD + 8字节尾部` 的总长度是48的倍数。
    
3. **添加尾部 (Trailer, 8字节):**
    
    - **UU (1字节):** 用户至用户指示。
        
    - **CPI (1字节):** 公共部分指示，通常为0。
        
    - **Length (2字节):** 原始数据包的有效长度（接收端据此去除PAD）。
        
    - **CRC-32 (4字节):** 对整个PDU进行错误检测 20。
        
4. **分段 (SAR):** 将CPCS-PDU切割为一系列48字节的块，放入ATM信元载荷。
    
5. **定界 (PTI):** 如何知道哪个信元是一个包的结束？AAL5利用ATM头部的 **PTI (Payload Type Indicator)** 字段。
    
    - 对于数据包的中间信元，PTI设为 `0`。
        
    - 对于数据包的最后一个信元，PTI设为 1 (EOM - End of Message)。
        
        这种机制使得AAL5无需在每个信元中浪费空间作为头部，实现了极高的带宽利用率 23。
        

### 3.4 IP over ATM 与逻辑IP子网 (LIS)

在ATM网络上运行IP（RFC 2225，原RFC 1577），面临最大的挑战是广播机制的缺失。IP依赖ARP广播解析MAC地址，但ATM没有广播功能。

**解决方案：逻辑IP子网 (LIS) 模型**

- 将ATM网络划分为若干逻辑子网（LIS）。
    
- 每个LIS配备一个 **ATMARP Server**。
    
- **解析流程：**
    
    1. 客户端启动时，通过配置的PVC或SVC连接到ATMARP Server，注册自己的IP和ATM地址（InARP）。
        
    2. 当客户端需要解析目标IP时，发送ARP Request给ATMARP Server（而非广播）。
        
    3. Server回复目标ATM地址。
        
    4. 客户端通过信令建立一条直达目标的SVC（Switched Virtual Circuit）进行数据传输。
        
        这种架构虽然解决了互通问题，但导致了著名的“N平方问题”（全网状连接导致VC数量爆炸），为后来的MPLS埋下了伏笔 25。
        

---

## 4. 多协议标签交换（MPLS）：链路虚拟化的集大成者

ATM虽然提供了强大的QoS和流量工程能力，但其复杂的信令（Q.2931）和“信元税”（Cell Tax，即5/53 ≈ 10%的头部开销）限制了其在高速IP骨干网的发展。MPLS吸取了ATM“标签交换”的精华，并将其应用于变长数据包，成为“第2.5层”协议的标准。

### 4.1 MPLS 标签操作与体系结构

MPLS在二层头（如Ethernet/PPP）和三层头（IP）之间插入一个**32位（4字节）的标签栈（Label Stack）**。

#### 4.1.1 标签头格式

|**字段**|**位宽**|**功能**|
|---|---|---|
|**Label**|20|标签值，用于转发索引。|
|**TC (Traffic Class)**|3|原名EXP，用于QoS优先级标记（CoS） 28。|
|**S (Bottom of Stack)**|1|栈底位。1表示这是最后一个标签，0表示内部还有标签（支持VPN嵌套） 29。|
|**TTL**|8|生存时间，防止环路。|

#### 4.1.2 转发平面动作

MPLS路由器（LSR）根据标签转发表（LFIB）执行以下操作：

1. **Push (压入):** 入口边缘路由器（Ingress PE）为IP包添加标签。
    
2. **Swap (交换):** 核心路由器（P Router）读取顶层标签，查找转发表，用新标签替换旧标签，转发数据。这与ATM的VPI/VCI交换逻辑完全一致，但无需分段 30。
    
3. **Pop (弹出):** 出口路由器移除标签。
    
    - **PHP (倒数第二跳弹出):** 为了减轻出口路由器的负担，通常由倒数第二跳路由器弹出顶层标签，出口路由器直接处理IP包或内层VPN标签 32。
        

### 4.2 MPLS 与 ATM/Frame Relay 的对比与融合

MPLS实际上是对ATM和帧中继（Frame Relay）思想的现代重构。

|**特性**|**帧中继 (Frame Relay)**|**ATM**|**MPLS**|
|---|---|---|---|
|**交换单元**|变长帧|定长信元 (53B)|变长数据包|
|**标识符**|DLCI (10位)|VPI/VCI (24/28位)|Label (20位)|
|**连接模式**|面向连接 (PVC/SVC)|面向连接 (PVC/SVC)|标签交换路径 (LSP)|
|**协议开销**|低|高 (信元头+填充)|低 (4字节 Shim)|
|**网络融合**|需独立覆盖网|需复杂映射 (CLIP)|与IP路由协议紧密集成 (LDP/RSVP)|

MPLS的最大贡献在于它**统一了控制平面**。在ATM时代，ATM交换机运行私有的PNNI信令，与IP路由协议隔离。而在MPLS中，标签的分发（LDP）直接依赖于IP路由表（OSPF/IS-IS），实现了“IP over Everything”的愿景，同时保留了电路交换的流量隔离和路径控制能力 32。

---

## 5. 结论

链路层的发展从简单的点对点连接（SLIP）演进到具备完善状态机和认证机制的PPP，再到适应宽带接入的PPPoE，最后发展出高度虚拟化的ATM和MPLS技术。这一过程体现了网络工程中的核心权衡：

1. **控制与效率的平衡：** PPP引入了LCP和NCP，增加了握手开销，但换来了链路的可配置性和多协议兼容性。
    
2. **适应介质的演进：** PPPoE通过在以太网广播介质上构建逻辑点对点隧道，成功延续了PPP的AAA特性，成为运营商宽带接入的标准。
    
3. **交换范式的融合：** ATM试图用定长信元统一通信世界，虽然因复杂性和开销在桌面端失败，但其“标签交换”和“虚电路”思想在MPLS中得到了重生和优化。MPLS摒弃了信元，保留了标签，成为现代骨干网流量工程和VPN服务的核心技术。
    

掌握这些协议不仅需要理解报文字段的位定义，更需要洞察其背后的状态机逻辑、填充算法以及在不同历史时期解决特定网络问题的设计哲学。